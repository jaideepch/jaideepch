/***************************************
* @preserve
* ForeSee Web SDK: Feedback Standalone Survey
* Built April 27, 19 22:09:37
* Code version: 19.4.0
* Template version: 19.4.0
***************************************/
_fsDefine(["require","fs",_fsNormalizeUrl("$fs.utils.js"),_fsNormalizeUrl("$fs.survey.js")],function(t,e,i,r){/**
   * @preserve
   * @@CONFIG_GOES_HERE@@
   */
var n={remove:function(){this.parentNode&&this.parentNode.removeChild(this)},hasClass:function(t){return this.className.indexOf(t)>-1},addClass:function(t){this.hasClass(t)||(this.className+=" "+t)},removeClass:function(t){this.className=(this.className||"").replace(t,""),this.className=this.className.replace(/[ ]+$/g,"")},$:function(t){return this.querySelectorAll(t)},css:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.style[e]=t[e])}},s=function(t){if("string"==typeof t&&-1==t.indexOf("<"))return document.querySelectorAll(t);if("string"==typeof t){var e=document.createElement("div");e.innerHTML=t,t=e.firstChild}for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);return t},o=function(){this.$el=s('<img src="'+_fsNormalizeUrl("$loader.gif")+'" class="acs-loader">'),this.moveOffScreen()};o.prototype.center=function(){var t=i.getSize(window),e=i.getScroll(window),r=this.$el.offsetWidth,n=this.$el.offsetHeight;this.$el.css({left:(t.w-r)/2+"px",top:(t.h-n)/2+e.y+"px",opacity:1,position:"absolute"})},o.prototype.moveOffScreen=function(){this.$el.css({left:"-999px",top:"-999px",opacity:0})},o.prototype.remove=function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)};i.eitherOr=function(t,e,i){return t[e]||t[i]},e.isDefined=function(t){return null!==t&&void 0!==t},e.isFunction=function(t){return"function"==typeof t},e.isObject=function(t){return"object"==typeof t},e.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},i.escapeRegExp=function(t){return t.toString().replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},i.trim=function(t){return t.toString().replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},e.proxy=function(t,e){var i,r,n=Function.prototype.bind,s=Array.prototype.slice;return n&&t.bind===n?n.apply(t,s.call(arguments,1)):(i=s.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(e,i.concat(s.call(arguments)));ctor.prototype=t.prototype;var n=ctor();ctor.prototype=null;var o=t.apply(n,i.concat(s.call(arguments)));return Object(o)===o?o:n})},e.dispose=function(t){if(t){if(t.length)for(var e=t.length-1;e>=0;e--)t[e]=null;for(var i in t){var r=typeof t[i];"function"!=r&&"object"!=r||(t[i]=null)}}t=null},e.ext=function(){var t,i,r,n=arguments,s=n[0]||{},o=1,a=arguments.length;for("object"==typeof s||e.isFunction(s)||(s={}),a===o&&(s=this,--o);o<a;o++)if(e.isDefined(t=n[o]))for(i in t)r=t[i],s!==r&&void 0!==r&&(s[i]=r);return s},e.toQueryString=function(t,i){var r,n=e.isDefined(i)?i+(i.indexOf("?")>-1?"&":"?"):"";if(t)for(var s in t)r=t[s],e.isString(r)||(r=JSON.stringify(r)),n+=e.enc(s)+"="+e.enc(r)+"&";return n},i.hashCode=function(t){var e,i=0,r="";if(0===t.length)return i;for(e=0;e<t.length;e++)r=t.charCodeAt(e),i=(i<<5)-i+r,i&=i;return i},i.copyIfDefined=function(t,r,n){for(var s,o=t.split("."),a=r[i.shift(o)],c=n;e.isDefined(a)&&o.length>0;)a=a[i.shift(o)];if(a){for(o=t.split(".");o.length&&(s=i.shift(o));)c=c[s]?c[s]:c[s]={};for(o=t.split("."),c=n;o.length&&(s=i.shift(o));)o.length>0?c=c[s]:c[s]=a}},i.merge=function(){for(var t={},r=arguments,n=0,s=r.length;n<s;n++){var o=r[n];if(e.isPlainObject(o))for(var a in o){var c=o[a],p=t[a];t[a]=p&&e.isPlainObject(c)&&e.isPlainObject(p)?i.merge(p,c):i.unlink(c)}}return t},i.unlink=function(t){var r;if(e.isPlainObject(t)){r={};for(var n in t)r[n]=i.unlink(t[n])}else if(e.isArray(t)){r=[];for(var s=0,o=t.length;s<o;s++)r[s]=i.unlink(t[s])}else r=t;return r},e.isPlainObject=function(t){if(!t||"[object Object]"!==Object.prototype.toString.call(t)||t.nodeType||t.setInterval)return!1;if(t.constructor&&!hasOwnProperty.call(t,"constructor")&&!hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1;var e;for(e in t);return void 0===e||hasOwnProperty.call(t,e)||!hasOwnProperty.call(t,e)&&hasOwnProperty.call(Object.prototype,e)};var a=function(t,e){var i;return i=new window.Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"),e?i(e):i},c=function(t,n,a,c,p,h,u){var f;if(this.isStandalone=u,this.cpps=new l(h),this.networkError=new i.FSEvent,p&&p.length>2){p=JSON.parse(decodeURIComponent(i.Compress.decompress(p)));for(var d in p)this.cpps.set(d,p[d])}if(this.br=n,this.didSubmit=!1,this.loader=new o,document.body.appendChild(this.loader.$el),t&&t.instances&&t.instances.length)for(var y=0;y<t.instances.length;y++)if(t.instances[y].mid==c){f=this.cfg=t.instances[y];break}if(void 0===f&&(t.preview||"preview"===h)){var m=e.getParam("datauri"),v=e.getParam("template")||"default";f=this.cfg={mid:c,datauri:m,posturi:"",reporturi:"",surveytype:"popup",autowhitelist:!0,preview:!0,template:v,replay:!1}}if(f){var g=this,b=n.isIE&&10==n.browser.actualVersion?" acsIE10":"";document.title=this.cfg.label,this.jrny=a,this.sv=new r.SurveyBuilder(this.cfg,this.cpps,this.br),this.sv.cfg.privacyuri=this.sv.cfg.privacyuri?this.sv.cfg.privacyuri:"http://www.foresee.com/about-us/privacy-policy/",this.sv.cfg.privacytext=this.sv.cfg.privacytext?this.sv.cfg.privacytext:"Privacy policy",this.$content=s('<div class="acsMainContainerMobile--'+f.template+b+'"></div>'),n.isMobile&&g.jrny&&g.jrny.addEventObj({name:"feedback_clicked_mobile",properties:{mid:[g.cfg.mid]}}),this.networkError.subscribe(e.proxy(function(t){g.jrny&&(t&&t.type?g.jrny.addEventObj({name:"survey_"+t.type,properties:{mid:[g.cfg.mid]}}):g.jrny.addEventObj({name:"server_error",properties:{mid:[g.cfg.mid]}})),this.renderError(t.type)},this)),this.initQ=new i.Async(!0,e.proxy(function(){this._getTemplatesAndRender()},this),e.proxy(function(){window.close()},this)),this.initQ.enqueue(e.proxy(function(t){this._getCSS(t)},this)),this.initQ.enqueue(e.proxy(function(t){this._getTemplate("serviceunavailable",t,e.proxy(function(t){this.errTemplate=t},this))},this))}i.Bind(window,"unload",function(){!g.didSubmit&&g.jrny&&g.jrny.addEventObj({name:"feedback_abandoned",properties:{mid:[g.cfg.mid]}})})};c.prototype._getTemplatesAndRender=function(){var t=new i.Async(!0,e.proxy(function(){this.renderSurvey()},this),e.proxy(function(){this.renderError()},this));t.enqueue(e.proxy(function(t){this._getSurveyData(e.proxy(function(e){this.survey=e,t.resolve()},this))},this)),t.enqueue(e.proxy(function(t){this._getTemplate("epilogue",t,e.proxy(function(t){this.epTemplate=t},this))},this)),t.enqueue(e.proxy(function(t){this._getTemplate("surveycontents",t,e.proxy(function(t){this.svContentsTemplate=t},this))},this)),t.enqueue(e.proxy(function(t){i.Healthy(this.br,["survey","static"],t.resolve,t.error)},this))},c.prototype._getCSS=function(t){i.loadCSS(_fsNormalizeUrl("$templates/feedback/"+(this.sv.cfg.template||"default")+"/fs.feedback.css"),function(e){e?t.resolve():t.error()},null,this.br)},c.prototype._getTemplate=function(t,r,n){var s=this.cfg.template||"default",o=_fsNormalizeUrl("$templates/feedback/"+s+"/"+t+".html");new i.JSONP({success:e.proxy(function(t){n(t),r&&r.resolve()},this),failure:e.proxy(function(t){r&&r.error()},this)}).get(o,"templates_feedback_"+s+"_")},c.prototype._showThankyou=function(){var t=this,e=a(this.epTemplate,this.survey);t.didSubmit=!0,this.$content.innerHTML=e;for(var r=this.$content.$("h1"),n=0;n<r.length;n++)s(r[n]).addClass("acs-feedback__heading acs-feedback__heading--h1");var o=this.$content.$(".acs-close-button")[0];this.cfg.preview||i.Bind(o,"click",function(){t.jrny&&t.jrny.addEventObj({name:"feedback_thankyou_clicked",properties:{mid:[t.cfg.mid]}}),window.close()}),this.hideLoad()},c.prototype.showLoad=function(){this.loader.center(),this.$content.css({opacity:0})},c.prototype.hideLoad=function(){this.loader.moveOffScreen(),this.$content.css({opacity:1})},c.prototype.renderSurvey=function(){var t=this;t.jrny&&t.jrny.addEventObj({name:"feedback_survey_shown",properties:{mid:[t.cfg.mid]}});var r=s("#acsPleaseWaitTable")[0];r.parentNode.removeChild(r),this.survey.ansLogoSrc=_fsNormalizeUrl("$p_b_foresee.svg");var n=a(this.svContentsTemplate,this.survey);this.$content.innerHTML=n,window.document.body.appendChild(this.$content),this.sv.bind(this.$content),this.sv.SubmitClicked.subscribe(e.proxy(function(){this.showLoad(),t.jrny&&t.jrny.addEventObj({name:"feedback_submitted",properties:{mid:[t.cfg.mid]}}),i.Healthy(this.br,["survey","static"],e.proxy(function(){this._postSurveyData(e.proxy(function(t){t?(this.cfg.preview||p.processImmediate(),this._showThankyou()):this.networkError.fire({type:"postdata_failed"})},this))},this),e.proxy(function(){this.networkError.fire({type:"postdata_failed"})},this))},this)),this.hideLoad()},c.prototype.renderError=function(t){this.$content.innerHTML=a(this.errTemplate,this.sv);var e=this.$content.$(".acs-serviceunavailable__message")[0];if("expired"===t){for(;e.firstChild;)e.removeChild(e.firstChild);this.sv.cfg.fbexpiremessage?e.appendChild(s("<p>"+this.sv.cfg.fbexpiremessage+"</p>")):e.appendChild(s(this._unencodeHTML(this.sv.defaultCfg.expired)))}else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(s(this._unencodeHTML(this.sv.defaultCfg.unavailable)))}document.body.appendChild(this.$content);for(var r=this.$content.$("h3"),n=0;n<r.length;n++)s(r[n]).addClass("acs-feedback__heading acs-feedback__heading--h1");var o=this.$content.$(".acs-close-button")[0];this.cfg.preview||i.Bind(o,"click",function(){window.close()}),this.hideLoad();var c=s("#acsPleaseWaitTable")[0];c&&c.parentNode.removeChild(c)},c.prototype._unencodeHTML=function(t){var e=/&lt;/gi,i=/&gt;/gi;return t.replace(e,"<").replace(i,">")},c.prototype._getSurveyData=function(t){if(this.sv.isExpired())this.networkError.fire({type:"expired"});else{this._surveyTimer=setTimeout(e.proxy(function(){this.networkError.fire({type:"timedout"})},this),1e4);new i.AjaxTransport({url:this.cfg.datauri,method:"GET",success:e.proxy(function(i){this.networkError.didFire||(clearTimeout(this._surveyTimer),this.sv.SurveyData.fire(i,e.proxy(function(e){t&&t(e)},this)))},this),failure:e.proxy(function(t){clearTimeout(this._surveyTimer),this.networkError.fire({type:"getdata_failed"})},this)}).send({data:{mid:this.cfg.mid,cachebust:(new Date).getTime(),version:this.cfg.version}})}},c.prototype._postSurveyData=function(t){if(this.cfg.preview)return void e.nextTick(function(){t&&t(!0)});this._surveyTimer=setTimeout(e.proxy(function(){this.networkError.fire({type:"timedout"})},this),1e4);var r=new i.AjaxTransport({url:this.sv.cfg.posturi,method:"POST",success:e.proxy(function(e){clearTimeout(this._surveyTimer),t&&t(!0)},this),failure:e.proxy(function(e){clearTimeout(this._surveyTimer),sessionStorage.setItem("acsFeedbackSubmitted","true"),t&&t(!1)},this)}),n=JSON.parse(this.sv._serialize()),s=i.Compress.compress(JSON.stringify(e.ext({rating:this.sv._getScore()},n)));this.isStandalone||(window.location.hash="fsSurveyComplete="+encodeURIComponent(s)),r.send({data:n,skipEncode:!0,contentType:"application/json"})};var p={cxrid:e.getParam("cxrid"),cxrurl:e.getParam("cxrurl"),processImmediate:function(){if(p.cxrid&&p.cxrurl){(new i.AjaxTransport).send({method:"GET",url:i.sign(p.cxrurl+"process/"+e.enc(p.cxrid)),failure:e.proxy(function(t){},this),success:e.proxy(function(t){},this)})}}},l=function(t){this.ns=t};l.prototype={set:function(t,i){if(e.supportsDomStorage){var r=JSON.parse(localStorage.getItem(this.ns)||"{}");r[t]=i,localStorage.setItem(this.ns,JSON.stringify(r))}},get:function(t){return JSON.parse(localStorage.getItem(this.ns)||"{}")[t]},all:function(){return JSON.parse(localStorage.getItem(this.ns)||"{}")}},function(t,e,i){this.from=t,this.to=e,this.diff=this.to-this.from,this.callback=i||function(){}}.prototype={_tween:function(t){return--t*t*t+1},go:function(t){this.stop(),this.tm=t,this.startTime=new Date,this.timer=setInterval(Utils.bind(function(){var t=new Date,e=t-this.startTime,i=Math.min(e/this.tm,1),r=this._tween(i);i>=1&&(clearInterval(this.timer),this.timer=null),this.val=r*this.diff+this.from,this.callback(this.val)},this),20)},stop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},e.winReady(function(){var t=new i.Browser;t.ready.subscribe(function(){var r,n,s,o,a,config,p,l,h=document.getElementsByTagName("head")[0];"true"==h.getAttribute("data-isstandalone")?(r=h.getAttribute("data-cid"),n=h.getAttribute("data-mid"),s=h.getAttribute("data-url"),o=h.getAttribute("data-post-url"),config={cxReplay:!1,instances:[{datauri:s,delay:0,disabled:!0,fbanimate:!1,fbdirection:"horizontal",fbfixed:!1,fblocation:"middleright",fbtype:"badge",icon:"aspark100.png",label:"Feedback",mid:n,popup:!0,posturi:o,reporturi:"https://voc.foresee.com/client/feedback-admin/summary",saved:null,template:"default",topics:[{answerId:"",id:"1",order:1,topicText:"Default Topic",whitelistActive:!1}],version:1}]},new c(config,t,null,n,null,"fs",!0)):(r=e.getParam("cid"),n=e.getParam("mid"),a=e.getParam("uid"),p=new i.Journey(r,n,a,t),l=JSON.parse(i.Compress.decompress(e.gwConfigOverride)),config=l.product,new c(config,t,p,config.mid||n,e.getParam("cpps"),e.getParam("ns"),!1))},!0,!0)})});