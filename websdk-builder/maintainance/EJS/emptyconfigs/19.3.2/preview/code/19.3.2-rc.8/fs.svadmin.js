/***************************************
* @preserve
* ForeSee Web SDK: Survey Admin Module
* Built February 21, 17 17:43:58
* Code version: 19.3.2-rc.8
* Template version: 19.3.2-rc.7
***************************************/
_fsDefine(["require","fs",_fsNormalizeUrl("$fs.utils.js"),"triggerconfig"],function(e,t,r,config){function n(e,t,r){var n,o,i,s,a=!1;return this.count=this.count?++this.count:1,n=this.count,o="load-css-"+n,i=document.createElement("link"),i.setAttribute("id",o),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),"undefined"!=typeof i.addEventListener?(i.addEventListener("load",function(){a||(a=!0,s&&clearTimeout(s),t(i))},!1),i.addEventListener("error",function(){s&&clearTimeout(s),r(i)},!1),s=setTimeout(function(){a=!0,t(i)},2e3)):"undefined"!=typeof i.attachEvent&&i.attachEvent("onload",function(){var e,n,s=document.styleSheets.length;try{for(;s--;)if(n=document.styleSheets[s],n.id===o)return e=n.cssText,a=!0,void t(i)}catch(e){}a||r(i)}),document.getElementsByTagName("head")[0].appendChild(i),i.setAttribute("href",e),i}if(r.registerProduct("foresee",config),config&&config.surveydefs)for(var o=0;o<config.surveydefs.length;o++)t.isString(config.surveydefs[o])&&(config.surveydefs[o]=r.compile(r.b64DecodeUnicode(config.surveydefs[o])));var i="Func",s="ion",a=function(e,t){var r;return r=new window[i+"t"+s]("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"),t?r(t):r},c=function(e){this.browser=e,this.stg=r.getGlobalStore(e)};c.prototype.loadResources=function(e){r.Healthy(this.browser,["static","brain"],t.proxy(function(){this.stg.ready.subscribe(t.proxy(function(){var o=t.makeURI("$templates/trigger/admintools/main.css"),i=t.makeURI("$templates/trigger/admintools/admin.html"),s=!1,a=!1,c=function(){s&&a&&e&&e()};n(o,function(e){return function(e){s=!0,c()}}(this));var l=new r.JSONP({success:t.proxy(function(e){a=!0,this.template=e,c()},this)});l.get(i,"templates_trigger_admintools_")},this),!0,!0)},this),t.proxy(function(){alert("Cannot connect to remote ForeSee state server.\nPlease connect to the Internet and try again.")},this))},c.prototype._applyValues=function(){var e,r={sp:{},lf:{}},n=document.querySelectorAll(".acsSPOverride"),o=document.querySelectorAll(".acsLFOverride");for(e=0;e<n.length;e++){var i=n[e].id,s=n[e].value,a=i.replace("_spovr_","");s&&s.length>0&&(r.sp[a]={reg:parseInt(s,10),outreplaypool:parseInt(s,10)})}for(e=0;e<o.length;e++){var c=o[e].id,l=o[e].value,u=c.replace("_lfovr_","");l&&l.length>0&&(r.lf[u]=parseInt(l,10))}var d=!1;document.getElementById("acsOverridePooling").checked&&(d=!0),r.pooloverride=d,this.stg.set("ovr",JSON.stringify(r),null,!0,null,t.proxy(function(){this.writeMessage("Override saved.")},this))},c.prototype.writeMessage=function(e){var t=document.getElementById("fsMessage");clearTimeout(this.wmTimeout),t&&(t.innerHTML=e||"",this.wmTimeout=setTimeout(function(){t.innerHTML=""},3e3))},c.prototype.render=function(){document.title="ForeSee Survey Administration Tool";var e=t.ext(this.browser,{siteLogo:t.config.staticUrl+"/logos/foresee/foresee.svg"},{defs:config.surveydefs}),n=a(this.template,e);document.body.innerHTML=n;var o=document.getElementById("acsSetValues");o&&r.Bind(o,"click",t.proxy(function(e){r.preventDefault(e),this.stg.reset(t.proxy(function(){this._applyValues()},this))},this));var i=document.getElementById("acsClearValues");i&&r.Bind(i,"click",t.proxy(function(e){r.preventDefault(e),this.stg.reset(t.proxy(function(){this.writeMessage("State cleared.")},this));for(var n=document.querySelectorAll(".acsSPOverride, .acsLFOverride"),o=0;o<n.length;o++)n[o].value="";document.getElementById("acsOverridePooling").checked=!1},this));var s=document.getElementById("acsReturnToSite");s&&r.Bind(s,"click",t.proxy(function(e){r.preventDefault(e);var t=window.location.href+"";window.location=t.substr(0,t.indexOf("#"))},this));var c=this.stg.get("ovr");if(c){c=JSON.parse(c),document.getElementById("acsOverridePooling").checked=c.pooloverride;for(var l in c.sp)try{document.getElementById("_spovr_"+l).value=c.sp[l].reg}catch(e){}for(var u in c.lf)try{document.getElementById("_lfovr_"+u).value=c.lf[u]}catch(e){}}},t.domReady(function(){var e=new r.Browser;e.ready.subscribe(function(){var r=new c(e);r.loadResources(t.proxy(function(){r.render()},this))},!0,!0)})});