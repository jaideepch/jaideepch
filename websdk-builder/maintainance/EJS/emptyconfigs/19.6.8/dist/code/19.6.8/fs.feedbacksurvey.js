/***************************************
* @preserve
* ForeSee Web SDK: Feedback Standalone Survey
* Built April 27, 19 21:41:45
* Code version: 19.6.8
* Template version: 19.6.8
***************************************/
_fsDefine(["require","fs",_fsNormalizeUrl("$fs.utils.js"),_fsNormalizeUrl("$fs.survey.js")],function(e,t,i,s){/**
   * @preserve
   * @@CONFIG_GOES_HERE@@
   */
var r={remove:function(){this.parentNode&&this.parentNode.removeChild(this)},hasClass:function(e){return this.className.indexOf(e)>-1},addClass:function(e){this.hasClass(e)||(this.className+=" "+e)},removeClass:function(e){this.className=(this.className||"").replace(e,""),this.className=this.className.replace(/[ ]+$/g,"")},$:function(e){return this.querySelectorAll(e)},css:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.style[t]=e[t])}},n=function(e){if("string"==typeof e&&-1==e.indexOf("<"))return document.querySelectorAll(e);if("string"==typeof e){var t=document.createElement("div");t.innerHTML=e,e=t.firstChild}for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i]);return e},o=function(){this.$el=n('<img src="'+_fsNormalizeUrl("$loader.gif")+'" class="acs-loader">'),this.$el.setAttribute("alt","loading survey"),this.$el.setAttribute("tabindex","-1"),this.$el.setAttribute("role","alert"),this.$el.setAttribute("aria-busy","true"),this.moveOffScreen()};o.prototype.center=function(){var e=i.getSize(window),t=i.getScroll(window),s=this.$el.offsetWidth,r=this.$el.offsetHeight;this.$el.css({left:(e.w-s)/2+"px",top:(e.h-r)/2+t.y+"px",display:"block",position:"absolute"})},o.prototype.moveOffScreen=function(){this.$el.css({left:"-999px",top:"-999px",display:"none"})},o.prototype.remove=function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)};var a=function(e,t){var i;return i=new window.Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"),t?i(t):i},c=function(e,r,a,c,d,h,u){var p;if(this.isStandalone=u,this.cpps=new l(h),this.networkError=new i.FSEvent,d){!t.isObject(d)&&d.length>2&&(d=JSON.parse(i.Compress.decompress(d)));for(var f in d)this.cpps.set(f,d[f])}if(this.br=r,this.didSubmit=!1,document.body.setAttribute("aria-live","assertive"),this.loader=new o,document.body.appendChild(this.loader.$el),e&&e.instances&&e.instances.length)for(var m=0;m<e.instances.length;m++)if(e.instances[m].mid==c){p=this.cfg=e.instances[m];break}if(void 0===p&&(e.preview||"preview"===h)){var v=t.getParam("datauri"),y=t.getParam("template")||"default";p=this.cfg={mid:c,datauri:v,posturi:"",reporturi:"",surveytype:"popup",autowhitelist:!0,preview:!0,template:y,replay:!1}}if(p){var g=this,b=r.isIE&&10==r.browser.actualVersion?" acsIE10":"";document.title=this.cfg.label,this.jrny=a,this.sv=new s.SurveyBuilder(this.cfg,this.cpps,this.br),this.sv.cfg.privacyuri=this.sv.cfg.privacyuri?this.sv.cfg.privacyuri:"http://www.foresee.com/about-us/privacy-policy/",this.sv.cfg.privacytext=this.sv.cfg.privacytext?this.sv.cfg.privacytext:"Privacy policy",this.$content=n('<div id="acsMainContentDialog" class="acsMainContainerMobile--'+p.template+b+'" role="dialog" aria-labelledby="acsFeedbackDialogTitle" aria-describedby="acsFeedbackDialogDesc" aria-live="assertive"></div>'),this.networkError.subscribe(t.proxy(function(e){g.jrny&&(e&&e.type?g.jrny.addEventObj({name:"feedback_survey_"+e.type,properties:{mid:[g.cfg.mid]}}):g.jrny.addEventObj({name:"feedback_server_error",properties:{mid:[g.cfg.mid]}})),this.renderError(e.type)},this)),this.initQ=new i.Async(!0,t.proxy(function(){this._getTemplatesAndRender()},this),t.proxy(function(){window.close()},this)),this.initQ.enqueue(t.proxy(function(e){this._getCSS(e)},this)),this.initQ.enqueue(t.proxy(function(e){this._getTemplate("serviceunavailable",e,t.proxy(function(e){this.errTemplate=e},this))},this))}i.Bind(window,"unload",function(){!g.didSubmit&&g.jrny&&g.jrny.addEventObj({name:"feedback_abandoned",properties:{mid:[g.cfg.mid]}})})};c.prototype._getTemplatesAndRender=function(){var e=new i.Async(!0,t.proxy(function(){this.renderSurvey()},this),t.proxy(function(){this.renderError()},this));e.enqueue(t.proxy(function(e){this._getSurveyData(t.proxy(function(t){this.survey=t,e.resolve()},this))},this)),e.enqueue(t.proxy(function(e){this._getTemplate("epilogue",e,t.proxy(function(e){this.epTemplate=e},this))},this)),e.enqueue(t.proxy(function(e){this._getTemplate("surveycontents",e,t.proxy(function(e){this.svContentsTemplate=e},this))},this))},c.prototype._getCSS=function(e){i.loadCSS(_fsNormalizeUrl("$templates/feedback/"+(this.sv.cfg.template||"default")+"/main.css"),function(t){t?e.resolve():e.error()},null,this.br)},c.prototype._getTemplate=function(e,s,r){var n=this.cfg.template||"default",o=_fsNormalizeUrl("$templates/feedback/"+n+"/"+e+".html");new i.JSONP({success:t.proxy(function(e){r(e),s&&s.resolve()},this),failure:t.proxy(function(e){s&&s.error()},this)}).get(o,"templates_feedback_"+n+"_")},c.prototype._showThankyou=function(){var e=this,t=a(this.epTemplate,this.survey);e.didSubmit=!0,this.$content.innerHTML=t;for(var s=this.$content.$("h1"),r=0;r<s.length;r++)n(s[r]).addClass("acs-feedback__heading acs-feedback__heading--h1");var o=this.$content.$(".acs-close-button")[0];this.cfg.preview||i.Bind(o,"click",function(){window.close()}),this.hideLoad()},c.prototype.showLoad=function(){document.body.setAttribute("aria-live","assertive"),document.getElementById("acsMainContentDialog").setAttribute("aria-live","assertive"),this.$content.css({display:"none"}),this.loader.center()},c.prototype.hideLoad=function(){this.loader.moveOffScreen(),i.hasClass(this.loader.$el,"acs-loader")&&this.loader.$el.setAttribute("aria-hidden",!0),this.$content.css({display:"block"}),setTimeout(function(){document.body.removeAttribute("aria-live"),document.getElementById("acsMainContentDialog").setAttribute("aria-live","off")},1e3)},c.prototype.renderSurvey=function(){var e=this,i=n("#acsPleaseWaitTable")[0];i.parentNode.removeChild(i),this.survey.meta.prologuetext=this._addTitleDescIds(this.survey.meta.prologuetext),this.survey.meta.epiloguetext=this._addTitleDescIds(this.survey.meta.epiloguetext),this.survey.ansLogoSrc=_fsNormalizeUrl("$p_b_foresee.svg");var s=a(this.svContentsTemplate,this.survey);this.$content.innerHTML=s,window.document.body.appendChild(this.$content),this.sv.bind(this.$content),e.jrny&&e.jrny.addEventObj({name:"feedback_survey_shown",properties:{mid:[e.cfg.mid]}}),this.sv.SubmitClicked.subscribe(t.proxy(function(){this.showLoad(),e.jrny&&e.jrny.addEventObj({name:"feedback_submitted",properties:{mid:[e.cfg.mid]}}),this._postSurveyData(t.proxy(function(e){e?(this.cfg.preview||d.processImmediate(),this._showThankyou()):this.networkError.fire({type:"postdata_failed"})},this))},this)),this.hideLoad()},c.prototype._addTitleDescIds=function(e){var t=document.createElement("div");t.innerHTML=e;var i=t.childNodes[0],s=t.childNodes[1],r="";if(t.childNodes.length>2)for(t.removeChild(t.childNodes[0]),s=document.createElement("div"),s.setAttribute("style","padding: 0; margin: 0;");t.hasChildNodes();){var n=t.firstChild;t.removeChild(n),s.appendChild(n)}return i.setAttribute("id","acsFeedbackDialogTitle"),r=i.outerHTML,s&&(s.setAttribute("id","acsFeedbackDialogDesc"),r+=s.outerHTML),r},c.prototype.renderError=function(e){this.$content.innerHTML=a(this.errTemplate,this.sv);var t=this.$content.$(".acs-serviceunavailable__message")[0];if("expired"===e){for(;t.firstChild;)t.removeChild(t.firstChild);this.sv.cfg.fbexpiremessage?t.appendChild(n("<p>"+this.sv.cfg.fbexpiremessage+"</p>")):t.appendChild(n(this._unencodeHTML(this.sv.defaultCfg.expired)))}else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(n(this._unencodeHTML(this.sv.defaultCfg.unavailable)))}document.body.appendChild(this.$content);for(var s=this.$content.$("h3"),r=0;r<s.length;r++)n(s[r]).addClass("acs-feedback__heading acs-feedback__heading--h1");var o=this.$content.$(".acs-close-button")[0];this.cfg.preview||i.Bind(o,"click",function(){window.close()}),this.hideLoad();var c=n("#acsPleaseWaitTable")[0];c&&c.parentNode.removeChild(c)},c.prototype._unencodeHTML=function(e){var t=/&lt;/gi,i=/&gt;/gi;return e.replace(t,"<").replace(i,">")},c.prototype._getSurveyData=function(e){if(this.sv.isExpired())this.networkError.fire({type:"expired"});else{this._surveyTimer=setTimeout(t.proxy(function(){this.networkError.fire({type:"timedout"})},this),1e4);new i.AjaxTransport({url:this.cfg.datauri,method:"GET",success:t.proxy(function(i){this.networkError.didFire||(clearTimeout(this._surveyTimer),this.sv.SurveyData.fire(i,t.proxy(function(t){e&&e(t)},this)))},this),failure:t.proxy(function(e){clearTimeout(this._surveyTimer),this.networkError.fire({type:"getdata_failed"})},this)}).send({data:{mid:this.cfg.mid,cachebust:(new Date).getTime(),version:this.cfg.version}})}},c.prototype._postSurveyData=function(e){if(this.cfg.preview)return void t.nextTick(function(){e&&e(!0)});this._surveyTimer=setTimeout(t.proxy(function(){this.networkError.fire({type:"timedout"})},this),1e4);var s,r=new i.AjaxTransport({url:this.sv.cfg.posturi,method:"POST",success:t.proxy(function(t){clearTimeout(this._surveyTimer),e&&e(!0)},this),failure:t.proxy(function(t){clearTimeout(this._surveyTimer),sessionStorage.setItem("acsFeedbackSubmitted","true"),e&&e(!1)},this)}),n=JSON.parse(this.sv._serialize());t.isArray(n.responses)&&n.responses.push({questionId:"deployment_type",answerText:this.isStandalone?"URL":"BADGE"}),s=i.Compress.compress(JSON.stringify(t.ext({rating:this.sv._getScore()},n))),this.isStandalone||(window.location.hash="fsSurveyComplete="+encodeURIComponent(s)),r.send({data:n,skipEncode:!0,contentType:"application/json"})};var d={cxrid:t.getParam("cxrid"),cxrurl:t.getParam("cxrurl"),processImmediate:function(){if(d.cxrid&&d.cxrurl){(new i.AjaxTransport).send({method:"GET",url:i.sign(d.cxrurl+"process/"+t.enc(d.cxrid)),failure:t.proxy(function(e){},this),success:t.proxy(function(e){},this)})}}},l=function(e){this.ns=e};l.prototype={set:function(e,i){if(t.supportsDomStorage){var s=JSON.parse(localStorage.getItem(this.ns)||"{}");s[e]=i,localStorage.setItem(this.ns,JSON.stringify(s))}},get:function(e){return JSON.parse(localStorage.getItem(this.ns)||"{}")[e]},all:function(){return JSON.parse(localStorage.getItem(this.ns)||"{}")}},function(e,t,i){this.from=e,this.to=t,this.diff=this.to-this.from,this.callback=i||function(){}}.prototype={_tween:function(e){return--e*e*e+1},go:function(e){this.stop(),this.tm=e,this.startTime=new Date,this.timer=setInterval(Utils.bind(function(){var e=new Date,t=e-this.startTime,i=Math.min(t/this.tm,1),s=this._tween(i);i>=1&&(clearInterval(this.timer),this.timer=null),this.val=s*this.diff+this.from,this.callback(this.val)},this),20)},stop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},t.winReady(function(){function e(){function e(e,s,a,h){if(e=t.ext({global:i.defaultConfigs.global},e),e.product&&e.product.instances&&(e.product.instances=e.product.instances.map(function(e){return t.ext({},i.defaultConfigs.survey,e)})),config=e.product||{},"preview"!==d){var u=i.APPID.FEEDBACK;n=new i.Journey(h,u,l,r)}return new c(config,r,n,s,a,d,o)}var config={},s=null,n=null,o=!1,a=t.getParam("mid"),d=t.getParam("ns");if("preview"!==d){var l=t.getParam("uid"),h=t.getParam("brain"),u=i.getBrainStorage(r,l,d,h);u.setUpdateInterval(500),u.watchForChanges(["fscfg"],function(r,n,o){u.stopUpdateInterval(),a=t.dec(o.mid),s=JSON.parse(i.Compress.decompress(t.dec(o.cpps))),e(JSON.parse(t.dec(i.Compress.decompress(t.dec(o.gcfg)))),a,s,o.cid)},!0,!0)}else{var p=t.getParam("_gcfg_");e(JSON.parse(t.dec(i.Compress.decompress(t.dec(p)))),a,null,null)}}function s(){var e=document.getElementsByTagName("head")[0],config={},t=[],i=e.getAttribute("data-url"),s=e.getAttribute("data-post-url"),n=e.getAttribute("data-version"),o=e.getAttribute("data-mid");return config={cxReplay:!1,instances:[{autowhitelist:!0,datauri:i,delay:0,disabled:!0,fbanimate:!1,fbdirection:"horizontal",fbfixed:!1,fblocation:"middleright",fbtype:"badge",icon:"aspark100.png",label:"Feedback",mid:o,popup:!0,posturi:s,reporturi:"https://voc.foresee.com/client/feedback-admin/summary",saved:null,template:"default",topics:[{answerId:"",id:"1",order:1,topicText:"Default Topic",whitelistActive:!1}],version:n||1}]},decodeURIComponent(location.search).substring(1).split("&").forEach(function(e,i,s){var r=e.match(/^cpp\[([\w\d\s]*)\]=(.*)$/i);r&&(t[r[1]]=r[2])}),new c(config,r,null,o,t,"fs",!0)}var r=new i.Browser;r.ready.subscribe(function(){"true"==document.getElementsByTagName("head")[0].getAttribute("data-isstandalone")?s():e()},!0,!0)})});